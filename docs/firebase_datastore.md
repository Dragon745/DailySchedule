# Firebase Datastore Structure - DailySchedule App

This document outlines the Firestore database structure for the DailySchedule application.

## Collections

### 1. `users` Collection

**Document ID**: User's UID from Firebase Auth

**Fields**:

- `uid` (string, required): User's unique identifier
- `email` (string, required): User's email address
- `displayName` (string, required): User's display name
- `photoURL` (string, optional): User's profile photo URL
- `createdAt` (timestamp, required): When the user account was created
- `lastLoginAt` (timestamp, required): Last login timestamp
- `preferences` (map, optional): User preferences
  - `timezone` (string): User's timezone
  - `defaultStartTime` (string): Default start time (HH:MM format)
  - `defaultEndTime` (string): Default end time (HH:MM format)
  - `workDays` (array): Array of work days (1-7, Monday=1)
  - `notifications` (boolean): Whether notifications are enabled

### 2. `categories` Collection

**Document ID**: Auto-generated by Firestore

**Fields**:

- `uid` (string, required): User's unique identifier
- `categoryId` (string, required): Unique category identifier
- `name` (string, required): Category name (max 50 chars)
- `description` (string, optional): Category description (max 200 chars)
- `color` (string, optional): Hex color code (e.g., #3B82F6)
- `icon` (string, optional): Icon identifier or emoji
- `type` (string, required): Category type - "main" or "sub"
- `parentCategoryId` (string, optional): For sub-categories, references the main category's categoryId
- `isActive` (boolean, required): Whether the category is active
- `createdAt` (timestamp, required): When the category was created
- `updatedAt` (timestamp, required): When the category was last updated
- `totalTimeSpent` (number, optional): Total time spent on this category (in milliseconds)
- `totalSessions` (number, optional): Total number of sessions for this category

**Predefined Main Categories**:

The system includes 8 predefined main categories that are automatically created when needed:

1. **Worship & Spiritual** (`predefined-worship-spiritual`)

   - Color: #8B5CF6 (Purple)
   - Icon: ğŸ™
   - Description: Main category for spiritual and religious activities

2. **Study & Learning** (`predefined-study-learning`)

   - Color: #3B82F6 (Blue)
   - Icon: ğŸ“š
   - Description: Main category for educational activities

3. **Work / Income** (`predefined-work-income`)

   - Color: #10B981 (Green)
   - Icon: ğŸ’¼
   - Description: Main category for work-related activities

4. **Personal Projects** (`predefined-personal-projects`)

   - Color: #F59E0B (Yellow)
   - Icon: ğŸš€
   - Description: Main category for personal development projects

5. **Opportunities & Challenges** (`predefined-opportunities-challenges`)

   - Color: #EF4444 (Red)
   - Icon: ğŸ¯
   - Description: Main category for challenges and opportunities

6. **Family & Relationships** (`predefined-family-relationships`)

   - Color: #EC4899 (Pink)
   - Icon: ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦
   - Description: Main category for family activities

7. **Self-Care & Rest** (`predefined-self-care-rest`)

   - Color: #06B6D4 (Cyan)
   - Icon: ğŸ§˜
   - Description: Main category for wellness activities

8. **Admin & Miscellaneous** (`predefined-admin-miscellaneous`)
   - Color: #6B7280 (Gray)
   - Icon: âš™ï¸
   - Description: Main category for administrative tasks

**Available Icon Options**:

- `default`: ğŸ“‹ (Default)
- `study`: ğŸ“š (Study)
- `work`: ğŸ’¼ (Work)
- `exercise`: ğŸƒ (Exercise)
- `prayer`: ğŸ™ (Prayer)
- `family`: ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ (Family)
- `health`: ğŸ¥ (Health)
- `hobby`: ğŸ¨ (Hobby)
- `social`: ğŸ‘¥ (Social)
- `admin`: âš™ï¸ (Admin)

**Available Color Options**:

15 predefined hex colors including:

- Blue (#3B82F6)
- Green (#10B981)
- Yellow (#F59E0B)
- Red (#EF4444)
- Purple (#8B5CF6)
- Pink (#EC4899)
- Cyan (#06B6D4)
- Gray (#6B7280)
- Emerald (#059669)
- Crimson (#DC2626)
- Violet (#7C3AED)
- Orange (#F97316)
- Sky (#0891B2)
- Rose (#BE185D)
- Teal (#059669)

**Example Structure**:

```
Main Category:
{
  uid: "user123",
  categoryId: "predefined-worship-spiritual",
  name: "Worship & Spiritual",
  description: "Main category: Worship & Spiritual",
  color: "#8B5CF6",
  icon: "ğŸ™",
  type: "main",
  parentCategoryId: null,
  isActive: true,
  createdAt: timestamp,
  updatedAt: timestamp,
  totalTimeSpent: 0,
  totalSessions: 0
}

Sub Category:
{
  uid: "user123",
  categoryId: "cat_1234567890",
  name: "Quran",
  description: "Daily Quran reading",
  color: "#3B82F6",
  icon: "prayer",
  type: "sub",
  parentCategoryId: "predefined-worship-spiritual",
  isActive: true,
  createdAt: timestamp,
  updatedAt: timestamp,
  totalTimeSpent: 0,
  totalSessions: 0
}
```

**Category Creation Logic**:

1. **Main Categories**: Automatically created when a sub-category references them
2. **Sub Categories**: User-created with required parent category selection
3. **Validation**: Prevents duplicate sub-categories under the same parent
4. **Auto-generation**: Main categories are created on-demand if they don't exist

### 3. `schedules` Collection

**Document ID**: Auto-generated by Firestore

**Fields**:

- `uid` (string, required): User's unique identifier
- `scheduleId` (string, required): Unique schedule identifier
- `categoryId` (string, required): References the category ID
- `categoryName` (string, required): Category name for display
- `title` (string, required): Schedule title (max 100 chars)
- `description` (string, optional): Schedule description (max 500 chars)
- `startTime` (string, required): Start time in HH:MM format
- `endTime` (string, required): End time in HH:MM format
- `daysOfWeek` (array, required): Array of days (1-7, Monday=1)
- `isRecurring` (boolean, required): Whether the schedule repeats
- `isActive` (boolean, required): Whether the schedule is active
- `priority` (number, optional): Priority level (1-3)
- `createdAt` (timestamp, required): When the schedule was created
- `updatedAt` (timestamp, required): When the schedule was last updated
- `estimatedDuration` (number, optional): Estimated duration in milliseconds

### 4. `timeTracking` Collection

**Document ID**: Auto-generated by Firestore

**Fields**:

- `uid` (string, required): User's unique identifier
- `trackingId` (string, required): Unique tracking identifier
- `categoryId` (string, required): References the category ID
- `categoryName` (string, required): Category name for display
- `title` (string, required): Session title (max 100 chars)
- `description` (string, optional): Session description (max 500 chars)
- `startTime` (timestamp, required): When tracking started
- `endTime` (timestamp, optional): When tracking ended
- `status` (string, required): Session status - "active", "completed", "paused", "cancelled"
- `duration` (number, optional): Session duration in milliseconds
- `notes` (string, optional): Additional notes (max 1000 chars)
- `tags` (array, optional): Array of tags (max 10)
- `createdAt` (timestamp, required): When the session was created
- `updatedAt` (timestamp, required): When the session was last updated

## Data Relationships

1. **User Isolation**: All collections use `uid` field to ensure users can only access their own data
2. **Category Hierarchy**:
   - Main categories have `type: "main"` and `parentCategoryId: null`
   - Sub-categories have `type: "sub"` and `parentCategoryId` pointing to a main category's `categoryId`
   - Predefined main categories are automatically created when referenced
3. **Schedule References**: Schedules reference categories via `categoryId`
4. **Time Tracking References**: Time tracking sessions reference categories via `categoryId`

## Security Rules

The Firestore security rules ensure:

- Users can only read/write their own data (uid-based access control)
- Data validation for required fields and data types
- Proper timestamp validation
- String length limits enforcement
- Category type validation (main/sub)
- Parent category relationship validation

## Implementation Notes

- **Predefined Categories**: Main categories are hardcoded and auto-created
- **User Categories**: Only sub-categories can be created by users
- **Color System**: 15 predefined hex colors for consistent theming
- **Icon System**: Mix of emoji and text-based icons
- **Tree Structure**: Categories displayed in hierarchical tree format
- **Mobile-First**: UI optimized for mobile devices with responsive design
